/*!
 * jQuery TinyValidate plugin v1.5.1
 *
 * Date: Mon Jun 27 11:37:41 2011 EDT
 * Requires: jQuery v1.3+
 *
 * Copyright 2010, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses (just like jQuery):
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * A (relatively) tiny validation plugin
 *
 *
*/
(function(a){function B(i){if(/(input|textarea|select)/i.test(i))return"inputs";else if(/(div|fieldset|p)/i.test(i))return"containers"}function C(i){for(var m in i)if(i.hasOwnProperty(m))return false;return true}function D(){window.console&&window.console.log&&console.log.apply(console,arguments)}function E(i,m){return i.replace(/\{([^\|]+)\|([^}]+)\}/g,function(o,q,n){return m*1==1?q:n})}var F=document.createElement("input");a.each(["required","pattern"],function(i,m){a.support[m]=m in F});a.tinyvalidate=
{version:"1.4",callCounter:-1,maxnum:0,rules:{}};var p={};p.inputs={};p.containers={};a.fn.tinyvalidate=function(i){a.tinyvalidate.callCounter++;var m=a.tinyvalidate.callCounter?"_"+a.tinyvalidate.callCounter:"",o=a.tinyvalidate.rules;if(C(o))return D("you must have at least one rule. see jquery.tinyvalidate.rules.js","alert");var q=this.find("*[required]").addClass("required");if(a.support.required)typeof a.fn.prop=="undefined"?q.removeAttr("required"):q.prop("required",false);return this.each(function(n){var g=
a(this),j=a([]);m+=n?"-"+n:"";var l=a.extend(true,{},a.fn.tinyvalidate.defaults,i||{},a.metadata?g.metadata():a.meta?g.data():{}),u=[],r=0,k=l.inline;if(i=="removeErrors"){a.each(o,function(b,c){g.find("."+c.ruleClass).each(function(){j=j.add(a(this))})});j.removeData("error").trigger("removeNotice").trigger("toggleErrorClass");g.trigger("hideSummary");return this}if(l.summary){var f=l.summary,s=a(f.wrapper).hide();a(f.insertTo=="form"?g[0]:f.insertTo)[f.insertType](s);if(f.lineItems)var t=f.lineItems.wrapper.match(/[^>]+>/g),
G=t[1]+t[0],w=f.lineItems.errorElement?f.lineItems.errorElement.match(/[^>]+>/g):["",""]}a.each(o,function(b,c){var d="."+c.ruleClass;g.find(d).each(function(){var e=B(this.nodeName)||"inputs",h=a(this),x=h.data("rule")||[],v=o[b],y=this.pattern;if(y)v=a.extend({},v,{rule:function(H){return RegExp(y).test(H)},text:"Field value is invalid."});if(!(this.nodeName==="DIV"&&h.has(d))){x.push(v);h.data("rule",x).data("ruleName",b).data("elementType",e);j=j.add(h);k&&h.data("insertion",p[e][k.insertType])}})});
if(k){k.errorElement&&j.bind("addNotice",function(b,c){var d=a(this),e=a.isFunction(d.data("rule")[c].text)?d.data("rule")[c].text.call(this):d.data("rule")[c].text,h=a(k.errorElement);h.html(e);h[a(this).data("insertion")](this).hide();h[k.errorAnimate.effect](k.errorAnimate.speed);d.bind("removeNotice",function(){h.remove()})});j.bind("toggleErrorClass",function(){var b=a(this),c=b.find('input[type="checkbox"], input[type="radio"]').length?b:b.closest(k.containerTag);b.data("error")?c.addClass(k.containerErrorClass):
c.removeClass(k.containerErrorClass)})}if(f){g.bind("displaySummary",function(b,c){s.hide();if(c){var d=f.preMessage.replace(/\{num\}/g,c);d=E(d,c);d=f.lineItems?d+t[0]+u.join(G)+t[1]+f.postMessage:d+f.postMessage;s.html(d)[f.messageAnimate.effect](f.messageAnimate.speed)}});g.bind("hideSummary",function(){s.hide()});f.lineItems&&g.bind("lineItemBuilder",function(b,c,d){b=a(c);var e=a("<div></div>").html(b.data("elementType")=="containers"?b.children(":first").html():b.prev().clone().html());e.children().remove();
e=e.text().replace(/[\*:\s]+$/,"");d=a.isFunction(d.text)?d.text.call(this):d.text;if(f.lineItems.linkify)e='<a href="#'+(b.data("elementType")=="containers"?b.find("input")[0].id:c.id)+'">'+e+"</a>";u.push(e+" "+w[0]+d+w[1])})}j.bind("validate",function(){var b=a(this).trigger("removeNotice"),c=b.data("rule"),d=c.length;b.removeData("error");for(var e=0;e<d;e++){c[e].elem&&c[e].elem(b);var h=c[e].check=="element"?b:b.val();if(!c[e].rule(h)&&!b.is(":hidden"))if(!(b.is(".required")&&c[e].ruleClass!=
"required"&&!b.val())){b.data("error","true").trigger("addNotice",[e]);g.trigger("lineItemBuilder",[this,c[e]]);r++}}b.trigger("toggleErrorClass")});g.bind("submit.tv",function(){r=0;u=[];j.trigger("validate");g.trigger("displaySummary",[r]);if(r)return false;else if(l.submitOverride){g.tinyvalidate("removeErrors");l.submitOverride.call(g[0],l);return false}});if(l.otherEvents){if(typeof l.otherEvents=="string")var z=l.otherEvents.split(/\s*,\s*/);for(n=z.length-1;n>=0;n--)j.bind(z[n]+".tv",function(b){b.type==
"click"&&!/^(?:radio|checkbox)$/i.test(b.target.type)||a(this).trigger("validate")})}})};a.fn.tinyvalidate.defaults={otherEvents:"blur",submitOverride:null};a.fn.tinyvalidate.defaults.inline={insertType:"after",errorElement:'<div class="error-message"></div>',errorAnimate:{effect:"fadeIn",speed:400},containerTag:"div",containerErrorClass:"error"};a.fn.tinyvalidate.defaults.summary={insertTo:"form",insertType:"append",wrapper:'<div class="error-summary"></div>',preMessage:"Please review the {num} highlighted {field|fields} and try again.<ul>",
postMessage:"</ul>",messageAnimate:{effect:"fadeIn",speed:400},lineItems:{wrapper:"<li></li>",errorElement:'<span class="error-message"></span>',linkify:true}};var A={append:"insertAfter",appendTo:"insertAfter",after:"insertAfter",insertAfter:"insertAfter",prepend:"insertBefore",prependTo:"insertBefore",before:"insertBefore",insertBefore:"insertBefore"};a.extend(p.inputs,A);a.extend(p.containers,A)})(jQuery);
